# Fuzzing Crypto

Code release for

> Fenzi, G., Gilcher, J., Virdia, F. (2026).
> Finding Bugs and Features Using Cryptographically-Informed Functional Testing.
> IACR Transactions on Cryptographic Hardware and Embedded Systems, 2026(1).
> https://eprint.iacr.org/2024/1122

## Dependencies

Docker

## Instructions to run

```bash
sudo bash -c "echo core >/proc/sys/kernel/core_pattern" # to enable afl++ fuzzing
bash build.sh
bash run.sh
```
A terminal within the container will open.

### To run experiments on liboqs

To run experiments on version:
- 2018-11, replace `ver_liboqs` with `old_liboqs` below.
- 0.4.0, replace `ver_liboqs` with `mid_liboqs` below.
- 0.8.0, replace `ver_liboqs` with `cur_liboqs` below.
- 0.14.0, replace `ver_liboqs` with `ches_liboqs` below.

Within the container, run
```bash
export LIBOQS=ver_liboqs
make ${LIBOQS}                                                    # to install dependences
python3 fuzz_liboqs.py --liboqs ${LIBOQS} --logfile ${LIBOQS}.log # to run experiments
python3 report.py --liboqs ${LIBOQS}                              # to collect results
```

Comment the values in `BLACKLIST` on lines 35-42 of `fuzz_liboqs.py` if you want a full run (it will take significantly longer).

### To run experiments on supercop 20240107

Within the container
```bash
make get_supercop                                                 # download supercop-20240107.tar.xz
make supercop                                                     # to install supercop and run experiments
python3 supercop_report.py                                        # to collect results
```

## Reports

The reports generated by the code above can be found inside `/reports/`, which is mounted as a volume within the docker container. The reports are generated in three formats, as SQLite database, as Excel file and as a Latex table.

The reports from the experiments described in the paper can be found in `/paper_reports/`.
The SQLite format was omitted due to the size of the databases.

## Baseline

### To run the baseline on liboqs
To run experiments on version:
- 2018-11, replace `ver_liboqs` with `old_liboqs_afl` below.
- 0.4.0, replace `ver_liboqs` with `mid_liboqs_afl` below.
- 0.8.0, replace `ver_liboqs` with `cur_liboqs_afl` below.
- 0.14.0, replace `ver_liboqs` with `ches_liboqs_afl` below.

Within the container, run
```bash
export LIBOQS=ver_liboqs
make ${LIBOQS}                                                    # to install dependences
python3 fuzz_liboqs_baseline.py --liboqs ${LIBOQS} --logfile ${LIBOQS}.log # to run experiments
python3 report_baseline.py --liboqs ${LIBOQS}                              # to collect results
```

### To run experiments on supercop 20240107

Within the container, run
```bash
make get_supercop                                                 # download supercop-20240107.tar.xz
make supercop_baseline                                            # to install supercop and run experiments
```

# License

This software is distributed under the GNU General Public License version 3. See LICENSE for more details.

# Contributors

Code was contributed by
- Jan Gilcher
- Fernando Virdia
- Giacomo Fenzi
